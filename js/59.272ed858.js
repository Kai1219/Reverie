"use strict";(self["webpackChunkreverie"]=self["webpackChunkreverie"]||[]).push([[59],{4639:function(e,t,a){a.d(t,{Z:function(){return y}});var o=a(6252),s=a(3577);const l={class:"modal fade",id:"delModal",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog modal-dialog-centered"},i={class:"modal-content"},d=(0,o._)("div",{class:"modal-header text-white border-0"},[(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),p={class:"modal-body text-center"},r=(0,o.Uk)(" 是否刪除"),u={class:"text-danger"},c=(0,o.Uk)("? "),m=(0,o._)("p",{class:"text-secondary text-sm"},"(刪除後將無法復原!!)",-1),h={class:"modal-footer"},_=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function b(e,t,a,b,g,C){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",n,[(0,o._)("div",i,[d,(0,o._)("div",p,[(0,o._)("p",null,[r,(0,o._)("strong",u,(0,s.zw)(a.title),1),c]),m]),(0,o._)("div",h,[_,(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=e=>C.delItem())}," 確定刪除 ")])])])],512)}var g=a(1339),C={props:["title"],mixins:[g.Z],methods:{delItem(){this.$emit("del-item")}}},v=a(3744);const f=(0,v.Z)(C,[["render",b]]);var y=f},3981:function(e,t,a){a.d(t,{Z:function(){return C}});var o=a(6252),s=a(3577),l=a(9963);const n={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center"},d=(0,o._)("span",{"aria-hidden":"true"},"«",-1),p=[d],r={key:0,class:"page-link"},u=["onClick"],c=(0,o._)("span",{"aria-hidden":"true"},"»",-1),m=[c];function h(e,t,a,d,c,h){return(0,o.wg)(),(0,o.iD)("nav",n,[(0,o._)("ul",i,[(0,o._)("li",{class:(0,s.C_)(["page-item",{disabled:1===a.pages.current_page}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,l.iM)((e=>h.emitPage(a.pages.current_page-1)),["prevent"]))},p)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.pages.total_pages,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{class:(0,s.C_)(["page-item",{active:e===a.pages.current_page}]),key:t},[e===a.pages.current_page?((0,o.wg)(),(0,o.iD)("span",r,(0,s.zw)(e),1)):((0,o.wg)(),(0,o.iD)("a",{key:1,class:"page-link",href:"#",onClick:(0,l.iM)((t=>h.emitPage(e)),["prevent"])},(0,s.zw)(e),9,u))],2)))),128)),(0,o._)("li",{class:(0,s.C_)(["page-item",{disabled:a.pages.current_page===a.pages.total_pages}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,l.iM)((e=>h.emitPage(a.pages.current_page+1)),["prevent"]))},m)],2)])])}var _={props:["pages"],methods:{emitPage(e){this.$emit("emit-pages",e)}}},b=a(3744);const g=(0,b.Z)(_,[["render",h]]);var C=g},9526:function(e,t,a){a.r(t),a.d(t,{default:function(){return ee}});var o=a(6252),s=a(3577);const l=(0,o._)("div",{class:"dash-title d-flex flex-column mt-3"},[(0,o._)("span",{class:"text-secondary position-relative deco-line"},"Coupon List"),(0,o._)("h2",{class:"mb-3 fw-bold"},"優惠碼")],-1),n={class:"container"},i={class:"text-end mt-4"},d={class:"table mt-4"},p=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{width:"120"},"標題"),(0,o._)("th",null,"優惠碼"),(0,o._)("th",{width:"120"},"折扣"),(0,o._)("th",{width:"120"},"截止日期"),(0,o._)("th",{width:"120"},"啟用"),(0,o._)("th",{width:"120"},"編輯")])],-1),r={key:0,class:"text-success fw-bold"},u={key:1},c={class:"btn-group"},m=["onClick"],h=["onClick"];function _(e,t,a,_,b,g){const C=(0,o.up)("CouponModal"),v=(0,o.up)("DelModal"),f=(0,o.up)("Pagination"),y=(0,o.up)("Loading");return(0,o.wg)(),(0,o.iD)(o.HY,null,[l,(0,o._)("section",null,[(0,o._)("div",n,[(0,o._)("div",i,[(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=e=>g.openCouponModal("create"))}," 建立新的優惠碼 ")]),(0,o._)("table",d,[p,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(b.coupons,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",null,(0,s.zw)(t.title),1),(0,o._)("td",null,(0,s.zw)(t.code),1),(0,o._)("td",null,(0,s.zw)(t.percent)+"%",1),(0,o._)("td",null,(0,s.zw)(e.$filters.date(t.due_date)),1),(0,o._)("td",null,[t.is_enabled?((0,o.wg)(),(0,o.iD)("span",r,"啟用")):((0,o.wg)(),(0,o.iD)("span",u,"未啟用"))]),(0,o._)("td",null,[(0,o._)("div",c,[(0,o._)("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e=>g.openCouponModal("edit",t)}," 編輯 ",8,m),(0,o._)("button",{type:"button",class:"btn btn-sm btn-info",onClick:e=>g.openCouponModal("delete",t)}," 刪除 ",8,h)])])])))),128))])])]),(0,o.Wm)(C,{"temporary-coupons":b.tempCoupons,status:b.status,onGetData:g.getCoupons,ref:"CouponsModal"},null,8,["temporary-coupons","status","onGetData"])]),(0,o.Wm)(v,{ref:"DelModal",onDelItem:g.deleteCoupon,title:b.tempCoupons.title},null,8,["onDelItem","title"]),(0,o.Wm)(f,{pages:b.pagination},null,8,["pages"]),(0,o.Wm)(y,{ref:"Loading"},null,512)],64)}var b=a(3981),g=a(9963);const C={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"CouponsModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog modal-xl modal-dialog-centered"},f={class:"modal-content"},y={class:"modal-header"},w={class:"modal-title",id:"CouponsModalLabel"},k={key:0},x={key:1},D=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),M={class:"modal-body"},$={class:"row"},L={class:"col-sm"},Z={class:"mb-3"},P=(0,o._)("label",{for:"title",class:"form-label"},"標題",-1),z={class:"mb-3"},U=(0,o._)("label",{for:"code",class:"form-label"},"優惠碼",-1),I={class:"row"},V={class:"col-md-6"},T=(0,o._)("label",{for:"percent",class:"form-label"},"折扣百分比",-1),W={class:"col-md-6"},H=(0,o._)("label",{for:"due_date"},"截止日期",-1),Y=(0,o._)("hr",null,null,-1),G={class:"mb-3"},K={class:"form-check"},S=(0,o._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),j={class:"modal-footer"},q=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function N(e,t,a,s,l,n){return(0,o.wg)(),(0,o.iD)("div",C,[(0,o._)("div",v,[(0,o._)("div",f,[(0,o._)("div",y,[(0,o._)("h5",w,["create"===a.status?((0,o.wg)(),(0,o.iD)("span",k,"新增產品")):"edit"===a.status?((0,o.wg)(),(0,o.iD)("span",x,"編輯產品")):(0,o.kq)("",!0)]),D]),(0,o._)("div",M,[(0,o._)("div",$,[(0,o._)("div",L,[(0,o._)("div",Z,[P,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=t=>e.temporaryCoupons.title=t),placeholder:"請輸入優惠碼標題"},null,512),[[g.nr,e.temporaryCoupons.title]])]),(0,o._)("div",z,[U,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":t[1]||(t[1]=t=>e.temporaryCoupons.code=t),placeholder:"請輸入優惠碼"},null,512),[[g.nr,e.temporaryCoupons.code]])]),(0,o._)("div",I,[(0,o._)("div",V,[T,(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",id:"percent","onUpdate:modelValue":t[2]||(t[2]=t=>e.temporaryCoupons.percent=t),min:"0",placeholder:"請輸入折扣百分比"},null,512),[[g.nr,e.temporaryCoupons.percent]])]),(0,o._)("div",W,[H,(0,o.wy)((0,o._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=e=>l.due_date=e)},null,512),[[g.nr,l.due_date]])])]),Y,(0,o._)("div",G,[(0,o._)("div",K,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=t=>e.temporaryCoupons.is_enabled=t),ref:"checkbox"},null,512),[[g.e8,e.temporaryCoupons.is_enabled]]),S])])])])]),(0,o._)("div",j,[q,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=e=>n.saveCoupon())}," 確定 ")])])])],512)}var O=a(1339),A={props:["temporary-coupons","status"],data(){return{tempCoupon:{},due_date:""}},mixins:[O.Z],methods:{saveCoupon(){let e="",t="";"create"===this.status?(e="https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/coupon",t="post"):"edit"===this.status&&(e=`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/coupon/${this.temporaryCoupons.id}`,t="put"),this.$http[t](e,{data:this.temporaryCoupons}).then((e=>{alert(e.data.message),this.$emit("get-data"),this.modal.hide()})).catch((e=>{alert(e.response.data.message)}))}},watch:{temporaryCoupons(){this.tempCoupon=this.temporaryCoupons;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}}},B=a(3744);const E=(0,B.Z)(A,[["render",N]]);var F=E,J=a(4639),Q=a(2676),R={data(){return{coupons:{},tempCoupons:{title:"",is_enabled:1,percent:100,code:""},status:"",pagination:{}}},components:{Pagination:b.Z,CouponModal:F,DelModal:J.Z,Loading:Q.Z},methods:{getCoupons(e=1){this.$refs.Loading.ToggleLoading("on");const t=`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/coupons?page=${e}`;this.$http.get(t).then((e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination})).catch((e=>{alert(e.data.message)})),this.$refs.Loading.ToggleLoading("off")},openCouponModal(e,t){const a=this.$refs.CouponsModal,o=this.$refs.DelModal;t?"edit"===e?(this.tempCoupons={...t},a.openModal(),this.status="edit"):"delete"===e&&(this.tempCoupons={...t},o.openModal(),this.status="delete"):(this.tempCoupons={},a.openModal(),this.tempCoupons={due_date:(new Date).getTime()/1e3,is_enabled:0,percent:100},this.status="create")},deleteCoupon(){const e=`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/coupon/${this.tempCoupons.id}`;this.$http.delete(e,{data:this.tempCoupons}).then((e=>{this.getCoupons(),alert(e.data.message)})).catch((e=>{alert(e.data.message)})),this.$refs.DelModal.hideModal()}},mounted(){this.getCoupons()}};const X=(0,B.Z)(R,[["render",_]]);var ee=X}}]);
//# sourceMappingURL=59.272ed858.js.map